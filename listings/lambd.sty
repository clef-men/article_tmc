\RequirePackage{xcolor}
\RequirePackage{amstext}

\definecolor{lambd_keyword1}{rgb}{0,0.1,0.6}
\definecolor{lambd_keyword3}{rgb}{0,0.4,0.4}
\definecolor{lambd_keyword2}{rgb}{0.3,0,0.5}
\definecolor{comment}{rgb}{0.5,0,0}

\lstdefinelanguage{Lambd}{
    keepspaces=true,
    texcl=false,
    sensitive=true,
    showstringspaces=false,
    tabsize=2,
    extendedchars=false,
    breaklines=false,
    basicstyle=\small,
    captionpos=b,
    flexiblecolumns=false,
% --------------------------------------------------
    alsoletter={
        '
    },
% --------------------------------------------------
    identifierstyle={\ttfamily\color{black}},
% --------------------------------------------------
    keywords=[1]{
        else,
        if,
        in,
        let,
        match,
        then,
        with,
    },
    keywordstyle=[1]{\ttfamily\color{lambd_keyword1}},
% --------------------------------------------------
    keywords=[2]{
        rec
    },
    keywordstyle=[2]{\ttfamily\color{lambd_keyword2}},
% --------------------------------------------------
    literate=*
        {-}{$-$}1
        {|}{{\textcolor{lambd_keyword1}{|}}}1
        {|->}{$\mapsto$}2
        {;}{{\textcolor{lambd_keyword1}{;}}}1
        {==>}{{$\textcolor{lambd_keyword1}{\Rightarrow}$}}2
        {@}{{\textcolor{lambd_keyword2}{@}}}1
        {(}{{\textcolor{lambd_keyword3}{(}}}1
        {)}{{\textcolor{lambd_keyword3}{)}}}1
        {\{}{{\textcolor{lambd_keyword3}{\{}}}1
        {\}}{{\textcolor{lambd_keyword3}{\}}}}1
        {[}{{\textcolor{lambd_keyword3}{[}}}1
        {]}{{\textcolor{lambd_keyword3}{]}}}1
        {.}{{\textcolor{lambd_keyword3}{.}}}1
        {:}{{\textcolor{lambd_keyword3}{:}}}1
        {,}{{\textcolor{lambd_keyword3}{,}}}1
        {<-}{{$\textcolor{lambd_keyword3}{\ \leftarrow\ }$}}1,
% --------------------------------------------------
    escapeinside={(*}{*)},
    escapebegin={\ttfamily\color{comment}(*},
    escapeend={*)},
% --------------------------------------------------
    morestring=[b]",
    stringstyle=\ttfamily,
}

\lstnewenvironment{Lambd}{%
    \lstset{
        language=Lambd,
        basicstyle=\ttfamily\normalsize
    }%
}{}

\def\lambd{%
    \lstinline[
        language=Lambd,
        basicstyle=\ttfamily\small
    ]%
}
\newcommand{\lambdText}[1]{\text{\lambd|#1|}}

% ------------------------------------------------------------------------------

\newcommand{\lambdZero}{%
    \term{0}%
}
\newcommand{\lambdOne}{%
    \term{1}%
}
\newcommand{\lambdTwo}{%
    \term{2}%
}
\newcommand{\lambdUnit}{%
    \term{\color{lambd_keyword3}{()}}%
}
\newcommand{\lambdFunc}[1]{%
    \term{\color{lambd_keyword2}{@}} #1%
}
\newcommand{\lambdLet}[3]{%
    \term{\color{lambd_keyword1}{let}}\ #1\ \term{=}\ #2\ \term{\color{lambd_keyword1}{in}}\ #3%
}
\newcommand{\lambdSeq}[2]{%
    #1\ \term{\color{lambd_keyword1}{;}}\ #2%
}
\newcommand{\lambdCall}[2]{%
    #1\ #2%
}
\newcommand{\lambdUminus}[1]{%
    - #1%
}
\newcommand{\lambdPlus}[2]{%
    #1\ \term{+}\ #2%
}
\newcommand{\lambdMinus}[2]{%
    #1 - #2%
}
\newcommand{\lambdEq}[2]{%
    #1\ \term{=}\ #2%
}
\newcommand{\lambdIf}[3]{%
    \term{\color{lambd_keyword1}{if}}\ #1\ %
    \term{\color{lambd_keyword1}{then}}\ #2\ %
    \term{\color{lambd_keyword1}{else}}\ #3%
}
\newcommand{\lambdConstr}[3]{%
    \term{\color{lambd_keyword3}{\{}}\, #1 \term{\color{lambd_keyword3}{,}}\, #2 \term{\color{lambd_keyword3}{,}}\, #3 \,\term{\color{lambd_keyword3}{\}}}%
}
\newcommand{\lambdConstrDet}[3]{%
    \term{\color{lambd_keyword3}{[}}\, #1 \term{\color{lambd_keyword3}{,}}\, #2 \term{\color{lambd_keyword3}{,}}\, #3 \,\term{\color{lambd_keyword3}{]}}%
}
\newcommand{\lambdLoad}[2]{%
    #1 \term{\color{lambd_keyword3}{.(}} #2 \term{\color{lambd_keyword3}{)}}%
}
\newcommand{\lambdStore}[3]{%
    #1 \term{\color{lambd_keyword3}{.(}} #2 \term{\color{lambd_keyword3}{)}}\ {\color{lambd_keyword3}{\leftarrow}}\ #3%
}
\newcommand{\lambdDef}[2]{%
    \term{\color{lambd_keyword2}{rec}}\ #1\ \term{=}\ #2%
}
\newcommand{\lambdPair}[2]{%
    \term{\color{lambd_keyword3}{(}} #1 \term{\color{lambd_keyword3}{,}}\, #2 \term{\color{lambd_keyword3}{)}}%
}
\newcommand{\lambdNil}{%
    \term{\color{lambd_keyword3}{[]}}%
}
\newcommand{\lambdCons}[2]{%
    #1\ \term{\color{lambd_keyword3}{::}}\ #2%
}
\newcommand{\lambdMatch}[5]{%
    \begin{array}{l}
            \term{\color{lambd_keyword1}{match}}\ #1\ \term{\color{lambd_keyword1}{with}}
        \\
            \term{\color{lambd_keyword1}{|}}\ \lambdNil\ \textcolor{lambd_keyword1}{\Rightarrow}\ #2
        \\
            \term{\color{lambd_keyword1}{|}}\ \lambdCons{#3}{#4}\ \textcolor{lambd_keyword1}{\Rightarrow}\ #5
    \end{array}%
}
\newcommand{\lambdHole}{%
    \blacksquare%
}