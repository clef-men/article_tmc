\begin{figure}[tp]
    \begin{mathparpagebreakable}
        \inferrule*[lab=SimPost]
            {
                \Phi (e_s, e_t)
            }{
                \iSim[\Chi]{\Phi}{e_s}{e_t}
            }
        \and
        \inferrule*[lab=SimBind]
            {
                \iSim[\Chi]{\lambdaAbs (e_s', e_t') \ldotp \iSim[\Chi]{\Phi}{K_s [e_s']}{K_t [e_t']}}{e_s}{e_t}
            }{
                \iSim[\Chi]{\Phi}{K_s [e_s]}{K_t [e_t]}
            }
        \\
        \inferrule*[lab=SimSrcPure]
            {
                e_s \pureStep{p_s} e_s'
            \and
                \iSim[\Chi]{\Phi}{e_s'}{e_t}
            }{
                \iSim[\Chi]{\Phi}{e_s}{e_t}
            }
        \and
        \inferrule*[lab=SimTgtPure]
            {
                e_t \pureStep{p_t} e_t'
            \and
                \iSim[\Chi]{\Phi}{e_s}{e_t'}
            }{
                \iSim[\Chi]{\Phi}{e_s}{e_t}
            }
        \\
        \inferrule*[lab=SimApplyProtocol]
            {
              \Chi(\Psi, e_s, e_t)
            \and
               \forall e_s', e_t' \ldotp
               \Psi(e_s', e_t') \iSepImp
               \iSim[\Chi]{\Phi}{e'_s}{e'_t}
            }{
                \iSim[\Chi]{\Phi}{e_s}{e_t}
            }
        \\
        \inferrule*[lab=SimSrcConstr1]
            {
                \iSim[\Chi]{\Phi}{
                    \begin{array}{l}
                        \lambdLet{x_1}{e_{s1}}{\\
                        \lambdLet{x_2}{e_{s2}}{\\
                        \lambdConstrDet{t}{x_1}{x_2}}}
                    \end{array}
                }{e_t}
            }{
                \iSim[\Chi]{\Phi}{\lambdConstr{t}{e_{s1}}{e_{s2}}}{e_t}
            }
        \and
        \inferrule*[lab=SimSrcConstr2]
            {
                \iSim[\Chi]{\Phi}{
                    \begin{array}{l}
                        \lambdLet{x_2}{e_{s2}}{\\
                        \lambdLet{x_1}{e_{s1}}{\\
                        \lambdConstrDet{t}{x_1}{x_2}}}
                    \end{array}
                }{e_t}
            }{
                \iSim[\Chi]{\Phi}{\lambdConstr{t}{e_{s1}}{e_{s2}}}{e_t}
            }
        \and
        \inferrule*[lab=SimTgtConstr]
            {
                \iSim[\Chi]{\Phi}{e_s}{
                    \begin{array}{l}
                        \lambdLet{x_1}{e_{t1}}{\\
                        \lambdLet{x_2}{e_{t2}}{\\
                        \lambdConstrDet{t}{x_1}{x_2}}}
                    \end{array}
                }
            \and
                \iSim[\Chi]{\Phi}{e_s}{
                    \begin{array}{l}
                        \lambdLet{x_2}{e_{t2}}{\\
                        \lambdLet{x_1}{e_{t1}}{\\
                        \lambdConstrDet{t}{x_1}{x_2}}}
                    \end{array}
                }
            }{
                \iSim[\Chi]{\Phi}{e_s}{\lambdConstr{t}{e_{t1}}{e_{t2}}}
            }
        \\
        \inferrule*[lab=SimSrcConstrDet]
            {
                \forall \loc_s \ldotp
                \loc_s \mapsto_s (t, v_{s1}, v_{s2}) \iSepImp
                \iSim[\Chi]{\Phi}{\loc_s}{e_t}
            }{
                \iSim[\Chi]{\Phi}{\lambdConstrDet{t}{v_{s1}}{v_{s2}}}{e_t}
            }
        \and
        \inferrule*[lab=SimTgtConstrDet]
            {
                \forall \loc_t \ldotp
                \loc_t \mapsto_t (t, v_{t1}, v_{t2}) \iSepImp
                \iSim[\Chi]{\Phi}{e_s}{\loc_t}
            }{
                \iSim[\Chi]{\Phi}{e_s}{\lambdConstrDet{t}{v_{t1}}{v_{t2}}}
            }
        \\
        \inferrule*[lab=SimSrcLoad]
            {
                (\loc_s + i) \mapsto_s v_s
                \\\\
                (\loc_s + i) \mapsto_s v_s \iSepImp
                \iSim[\Chi]{\Phi}{v_s}{e_t}
            }{
                \iSim[\Chi]{\Phi}{\lambdLoad{\loc_s}{i}}{e_t}
            }
        \and
        \inferrule*[lab=SimSrcStore]
            {
                (\loc_s + i) \mapsto_s v_s
                \\\\
                (\loc_s + i) \mapsto_s w_s \iSepImp
                \iSim[\Chi]{\Phi}{\lambdUnit}{e_t}
            }{
                \iSim[\Chi]{\Phi}{\lambdStore{\loc_s}{i}{w_s}}{e_t}
            }
        \\
        \inferrule*[lab=SimTgtLoad]
            {
                (\loc_t + i) \mapsto_t v_t
                \\\\
                (\loc_s + i) \mapsto_t v_t \iSepImp
                \iSim[\Chi]{\Phi}{e_s}{v_t}
            }{
                \iSim[\Chi]{\Phi}{e_s}{\lambdLoad{\loc_t}{i}}
            }
        \and
        \inferrule*[lab=SimTgtStore]
            {
                (\loc_t + i) \mapsto_t v_t
                \\\\
                (\loc_t + i) \mapsto_t w_t \iSepImp
                \iSim[\Chi]{\Phi}{e_s}{\lambdUnit}
            }{
                \iSim[\Chi]{\Phi}{e_s}{\lambdStore{\loc_t}{i}{w_t}}
            }
        \\
        \inferrule*[lab=SimBijInsert]
            {
                \loc_s \mapsto_s v_s
            \and
                \loc_t \mapsto_t v_t
            \and
                v_s \iSimilar v_t
            \and
                \loc_s \iInBij \loc_t \iSepImp
                \iSim[\Chi]{\Phi}{e_s}{e_t}
            }{
                \iSim[\Chi]{\Phi}{e_s}{e_t}
            }
        \\
        \inferrule*[lab=SimLoad]
            {
                \loc_s \iSimilar \loc_t
            \and
                \forall v_s, v_t \ldotp
                v_s \iSimilar v_t
                \iSepImp
                \Phi (v_s, v_t)
            }{
                \iSim[\Chi]{\Phi}{\lambdLoad{\loc_s}{i}}{\lambdLoad{\loc_t}{i}}
            }
        \and
        \inferrule*[lab=SimStore]
            {
                \loc_s \iSimilar \loc_t
            \and
                v_s \iSimilar v_t
            \and
                \Phi (\lambdUnit, \lambdUnit)
            }{
                \iSim[\Chi]{\Phi}{\lambdStore{\loc_s}{i}{v_s}}{\lambdStore{\loc_t}{i}{v_t}}
            }
    \end{mathparpagebreakable}
    \caption{Reasoning rules for simulation (excerpt, omitting freshness conditions)}
    \label{fig:sim_rules}
\end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
