\begin{figure}[tp]
    \begin{tabular}{rcl}
            $\iProt_\mathrm{dir} (\iPredTwo, \datalangExpr_s, \datalangExpr_t)$
            & $\coloneqq$ &
            $\exists \datalangFn, \datalangVal_s, \datalangVal_t \ldotp$
        \\
            &&
            $\datalangFn \in \dom{\datalangProg_s} \iSep
            \datalangExpr_s = \datalangCall{\datalangFnptr{\datalangFn}}{\datalangVal_s} \iSep
            \datalangExpr_t = \datalangCall{\datalangFnptr{\datalangFn}}{\datalangVal_t} \iSep
            \datalangVal_s \iSimilar \datalangVal_t \iSep {}$
        \\
            &&
            $\forall \datalangVal_s', \datalangVal_t' \ldotp
            \datalangVal_s' \iSimilar \datalangVal_t' \iSepImp
            \iPredTwo (\datalangVal_s', \datalangVal_t')$
        \\
            $\iProt_\mathrm{DPS} (\iPredTwo, \datalangExpr_s, \datalangExpr_t)$
            & $\coloneqq$ &
            $\exists \datalangFn, \datalangFn_\mathit{dps}, \datalangVal_s, \datalangLoc, \datalangIdx, \datalangVal_t \ldotp$
        \\
            &&
            $\datalangFn \in \dom{\datalangProg_s} \iSep
            \datalangRenaming [\datalangFn] = \datalangFn_\mathit{dps} \iSep
            \datalangExpr_s = \datalangCall{\datalangFnptr{\datalangFn}}{\datalangVal_s} \iSep
            \datalangExpr_t = \datalangCall{\datalangFnptr{\datalangFn_\mathit{dps}}}{\datalangPair{\datalangPair{\datalangLoc}{\datalangIdx}}{\datalangVal_t}} \iSep
            \datalangVal_s \iSimilar \datalangVal_t \iSep {}$
        \\
            &&
            $(\datalangLoc + \datalangIdx) \iPointsto \datalangHole \iSep {}$
        \\
            &&
            $\forall \datalangVal_s', \datalangVal_t' \ldotp
            (\datalangLoc + \datalangIdx) \iPointsto \datalangVal_t' \iSep
            \datalangVal_s' \iSimilar \datalangVal_t' \iSepImp
            \iPredTwo (\datalangVal_s', \datalangUnit)$
        \\
            $\iProt_\mathrm{TMC}$
            & $\coloneqq$ &
            $\iProt_\mathrm{dir} \sqcup \iProt_\mathrm{DPS}$
    \end{tabular}
    \caption{TMC protocol}
    \label{fig:protocol}
\end{figure}