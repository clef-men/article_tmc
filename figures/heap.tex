\begin{figure}[tp]
	\centering
	\begin{tabular}{|c|ccc||c|ccc|}
		\hline
				\multicolumn{4}{|c||}{\bf{Source program}}
			&
				\multicolumn{4}{c|}{\bf{Transformed program}}
		\\ \hline
				\bf{Heap}
			&
				\multicolumn{3}{c||}{\bf{Position}}
			&
				\bf{Heap}
			&
				\multicolumn{3}{c|}{\bf{Position}}
		\\ \hline
				$\emptyset$
			&
				$\rightarrow$
			&
				$\lambdCall{\lambdText{map}}{\loc_1}$
			&
			&
				$\emptyset$
			&
				$\rightarrow$
			&
				$\lambdCall{\lambdText{map}}{\loc_1}$
			&
		\\ \hline
				$\emptyset$
			&
				$\rightarrow$
			&
				$\lambdCall{\lambdText{map}}{\loc_2}$
			&
			&
				$\loc_1' \mapsto (\mathrm{CONS}, v_1', \lambdHole)$
			&
				$\rightarrow$
			&
				$\lambdCall{\lambdText{map\_dps}}{\lambdPair{\lambdPair{\loc_1'}{\lambdTwo}}{\loc_2}}$
			&
		\\ \hline
				$\emptyset$
			&
				$\rightarrow$
			&
				$\lambdCall{\lambdText{map}}{\loc_3}$
			&
			&
				$\begin{array}{l}
						\loc_1' \mapsto (\mathrm{CONS}, v_1', \loc_2') \iSep {}
					\\
						\loc_2' \mapsto (\mathrm{CONS}, v_2', \lambdHole)
				\end{array}$
			&
				$\rightarrow$
			&
				$\lambdCall{\lambdText{map_dps}}{\lambdPair{\lambdPair{\loc_2'}{\lambdTwo}}{\loc_3}}$
			&
		\\ \hline
				$\textcolor{teal}{\loc_3'} \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit)$
			&
			&
				$\lambdCall{\lambdText{map}}{\loc_3}$
			&
				$\rightarrow$
			&
				$\begin{array}{l}
						\loc_1' \mapsto (\mathrm{CONS}, v_1', \loc_2') \iSep {}
					\\
						\loc_2' \mapsto (\mathrm{CONS}, v_2', \loc_3') \iSep {}
					\\
                        \textcolor{teal}{\loc_3'} \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit)
				\end{array}$
			&
			&
				$\lambdCall{\lambdText{map\_dps}}{\lambdPair{\lambdPair{\loc_2'}{\lambdTwo}}{\loc_3}}$
			&
				$\rightarrow$
		\\ \hline
				$\begin{array}{l}
				        \textcolor{teal}{\loc_3'} \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit) \iSep {}
                    \\
				        \textcolor{blue}{\loc_2'} \mapsto (\mathrm{CONS}, v_2', \loc_3')
				\end{array}$
			&
			&
				$\lambdCall{\lambdText{map}}{\loc_2}$
			&
				$\rightarrow$
			&
				$\begin{array}{l}
						\loc_1' \mapsto (\mathrm{CONS}, v_1', \loc_2') \iSep {}
					\\
						\textcolor{blue}{\loc_2'} \mapsto (\mathrm{CONS}, v_2', \loc_3')
					\\
                        \textcolor{teal}{\loc_3'} \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit)
				\end{array}$
			&
			&
				$\lambdCall{\lambdText{map\_dps}}{\lambdPair{\lambdPair{\loc_1'}{\lambdTwo}}{\loc_2}}$
			&
				$\rightarrow$
		\\ \hline
				$\begin{array}{l}
				        \textcolor{teal}{\loc_3'} \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit) \iSep {}
                    \\
						\textcolor{blue}{\loc_2'} \mapsto (\mathrm{CONS}, v_2', \loc_3') \iSep {}
					\\
						\textcolor{red}{\loc_1'} \mapsto (\mathrm{CONS}, v_1', \loc_2')
				\end{array}$
			&
			&
				$\lambdCall{\lambdText{map}}{\loc_1}$
			&
				$\rightarrow$
			&
				$\begin{array}{l}
						\textcolor{red}{\loc_1'} \mapsto (\mathrm{CONS}, v_1', \loc_2') \iSep {}
					\\
						\textcolor{blue}{\loc_2'} \mapsto (\mathrm{CONS}, v_2', \loc_3')
					\\
                        \textcolor{teal}{\loc_3'} \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit)
				\end{array}$
			&
			&
				$\lambdCall{\lambdText{map}}{\loc_1}$
			&
				$\rightarrow$
		\\ \hline
	\end{tabular}
	\captionsetup{format=hang}
	\caption{Execution of \lambd{map} in the source program and the transformed program from the heap ${\loc_1 \mapsto (\mathrm{CONS}, v_1, \loc_2) \iSep \loc_2 \mapsto (\mathrm{CONS}, v_2, \loc_3) \iSep \loc_3 \mapsto (\mathrm{NIL}, \lambdUnit, \lambdUnit)}$}
	\label{fig:heap}
\end{figure}