\begin{figure}[tp]
\begin{minipage}{.45\columnwidth}
\begin{Lambd}
map |-> rec arg =
  let fn = arg.(1) in
  let xs = arg.(2) in
  match xs with
  | [] ==> 
      []
  | x :: xs ==>
      let y = fn x in
      let dst = y :: () in
      @map_dps ((dst, 2), (fn, xs)) ;
      dst
\end{Lambd}
\end{minipage}
\hfill
\begin{minipage}{.45\columnwidth}
\begin{Lambd}
map_dps |-> rec arg' =
  let dst_idx = arg'.(1) in
  let dst = dst_idx.(1) in
  let idx = dst_idx.(2) in
  let arg = arg'.(2) in
  let fn = arg.(1) in
  let xs = arg.(2) in
  match xs with
  | [] ==> 
      dst.(idx) <- []
  | x :: xs ==>
      let y = fn x in
      let dst' = y :: () in
      dst.(idx) <- dst' ;
      @map_dps ((dst', 2), (fn, xs))
\end{Lambd}
\end{minipage}
\caption{\lambd|map| in destination-passing style (\LambdaLang)}
\label{fig:lambda_map_dps}
\end{figure}